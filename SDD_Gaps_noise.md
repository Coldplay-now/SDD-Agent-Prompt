# SDD中的四大鸿沟与噪声治理

 ```本文写于2025/09/17```

在AI集成开发环境（AI IDE）中，规范驱动开发（Specification-Driven Development, SDD）范式正重新定义生产代码的效率。其关键不同在于，产品经理或开发者通过自然语言描述意图，LLM自动生成规范（PRD）、设计（Spec）、任务列表（Tasklist）、代码，最终实现10x效能的软件开发。

我相信SDD面向未来的软件工程模式，这是软件生产模式的巨大的飞跃。它让更多人，以更高效地方式介入到数字化创新之中。

尽管在一些稍微复杂的项目中，采用SDD的模式，代码表现就会里出外进，里倒歪斜，然而我依然认为SDD有巨大的生命力，这是任何新生物种的自然规律。


## 1. SDD的现实挑战

SDD，并不是开发者把规范SPEC制定好后就有了一劳永逸的、自动化开发的方案。至少今天还不是。

我们需要深潜当下问题，从而找到应对策略，释放SDD这种设计思想以及LLM的价值。LLM并非全知全能的设计师，这是一个基于概率的推理工具，它天然有一种倾向去制造"无效需求"、"过度设计"和"过度工作"这的噪声。如果你简单套用SDD模式，很容易陷入"噪声过载"的困境。

## 2. 四个本质性的鸿沟（Gaps）

更深层次的问题在于，从开发者意图到最终实现的链条中，存在着四个本质性的鸿沟（Gaps）。

这四种Gaps是软件设计与开发的流程中固有的。即使没有LLM也会存在。在SDD的模式下，随着使用者的放手，当我们试图利用LLM跨越这些Gap时，不知不觉中也纵容了噪声的存在。这些噪声累计放大了误差，最终导致了项目coding的完全失败。

### 2.1 四大鸿沟对比表

| 鸿沟类型 | 转换过程 | 核心挑战 | LLM的局限性 | 传统开发模式|
|---------|---------|---------|------------|------------------|
| **Gap 1: 意图→PRD** | 模糊抽象的商业目标 → 具体无歧义的需求文档 | 隐含上下文和未言明假设的理解 | 无法理解言外之意，只能基于文本模式补全 | 人类的经验判断和沟通能力 |
| **Gap 2: PRD→设计** | 需求文档 → 详细的SPEC设计(功能/交互/架构/数据/API) | 多维度设计的相互依赖和影响 | 价值判断飘忽不定，依赖训练数据的技术组合 | 产品经理和开发者的主观能动性、经验和权衡取舍 |
| **Gap 3: 设计→任务** | 设计方案 → 原子化、可排序、可执行的工作项 | 理解依赖关系、优先级和颗粒度 | 生成的任务清单容易产生冗余或遗漏 | 开发者对项目整体的把控和拆分经验 |
| **Gap 4: 任务→实现** | 文本描述的任务指令 → 准确、高效、安全的代码 | 从"可沟通的理解偏差"变为"不可预测的生成偏差" | 语法完美但可能存在隐秘逻辑错误和安全隐患 | 人类的逻辑思维和安全意识 |

### Gap 1: 从意图到PRD之沟

制定PRD，是为了将模糊、抽象的商业目标和想法，转化为具体、无歧义、可执行的需求说明文档。

开发者的意图中充满隐含上下文，也包含许多未言明的假设。我们期待PRD具体明确。但是在LLM生成PRD的过程中，LLM无法理解言外之意，只能基于文本模式进行补全。除了开发者未表明的意图之外，LLM制定的PRD，也有很多语义上的模糊地带。

### Gap 2: 从PRD到设计之沟

制定详细的SPEC设计，包括很多方面，功能设计、交互设计、系统的架构设计、数据结构设计、API接口设计。它们互相依赖，互相影响。

在以往的开发模式中，产品经理和开发者的主观能动性发挥关键作用。他们的经验、常识、习惯、风格、好奇心、判断力和权衡取舍，在项目中发挥关键的作用。

LLM在这种本质的价值判断上，还是飘忽不定的。在技术决策方面，它依赖训练数据中的技术组合。在检查PRD的一致性和适用性上，并不具备天然的能力。

### Gap 3: 从设计到任务之沟

这个阶段，开发者利用LLM制定Tasklist，将设计方案拆解为原子化、可排序、可执行的工作项。这需要开发者理解工作之间的依赖关系、优先级和颗粒度。

LLM能生成任务列表，但往往需要开发者进一步评估拆完整性和效率。仅凭LLM生成的任务清单，很容易产生冗余或遗漏。

### Gap 4: 从任务到实现之沟

此期间，我们期待LLM将文本描述的tasklist任务指令，转换为准确、高效、安全且符合约束的代码。

当开发主体从人类变为LLM时，此Gap的性质发生巨变，它从"可沟通的理解偏差"变为"不可预测的生成偏差"。

## 3. 关键问题：滋生噪声

在我们允许LLM在奋力跨越每一个Gap时，都会因其"贪图完整、屎上雕花"的本性，制造大量的噪声（noises）。应对这个挑战是AI IDE厂商努力的方向，也是使用AI的开发者要面对的全新的课题。

### 3.1 四类噪声汇总表

| 噪声类型 | 产生阶段 | 具体表现 | 根本原因 | 危害程度 | 典型案例 |
|---------|---------|---------|---------|---------|---------|
| **无效需求** | 意图→PRD | 补全看似相关但不必要的功能需求；过度详细描述非核心边角功能 | LLM无法理解言外之意，基于文本模式补全 | 中等 | 为简单工具添加复杂的用户权限系统 |
| **过度设计** | PRD→设计 | 选择复杂"时髦"技术栈；设计过度抽象的API；引入不必要的设计模式 | LLM倾向于显得"专业"，依赖训练数据的技术组合 | 高 | 简单CRUD应用使用微服务架构 |
| **过度工作** | 设计→任务 | 包含大量冗余、无效或优先级错乱的任务项 | 基于有噪声的PRD和SPEC设计进行任务拆分 | 中等 | 将简单功能拆分成过多细粒度任务 |
| **逻辑与安全隐患** | 任务→实现 | 语法完美但有隐秘逻辑错误；引入安全反模式；API"幻觉" | 累积放大前期噪声，自动化编程缺乏人工审核 | 极高 | SQL注入漏洞、过度拆分的API接口 |

### 从意图到PRD：滋生"无效需求"

从理解开发者意图到设计PRD的过程中，它会滋生"无效需求"。LLM会补全看似相关，但实际不必要的功能需求，或过度详细地描述非核心的边角功能，污染PRD的纯净性。

### 从PRD到设计：滋生"过度设计"

从PRD转化到详细设计过程中，滋生"过度设计"。LLM倾向于选择复杂、"时髦"的技术栈，设计过度抽象的API，或引入不必要的设计模式，以显得"专业"，从而增加系统复杂性和维护成本。

### 从设计到任务：滋生"过度工作"

从详细设计到任务列表的转化过程中，滋生"过度工作"。基于有噪声的PRD和SPEC设计，LLM生成的任务清单会包含大量冗余、无效或优先级错乱的任务项，导致开发资源浪费。

### 从任务到实现：滋生"逻辑与安全隐患"

从任务列表转化为代码实现的过程中，会继续放大之前累积的噪声，滋生更多的"逻辑与安全隐患"。这是自动化编程模式下最难以控制的噪声。LLM生成的代码语法完美，但有隐秘的逻辑错误，或大规模引入安全反模式（如SQL注入）、API"幻觉"（过度拆分）。

## 4. 降噪策略：将LLM定位为生成工具，而非决策主体

实施SDD的关键，不在于消除Gap（这是不可能的），而在于系统地管理Gap。实施SDD的关键，也不在于完全信任LLM，而在于建立严格的流程来过滤和审计其输出。

我们需要一套"前置锚定、过程过滤、后置校验、测试并行"的机制。

### 4.1 降噪策略系统化表格

| 策略类型 | 实施阶段 | 核心原则 | 具体措施 | 预期效果 | 实施难度 |
|---------|---------|---------|---------|---------|---------|
| **前置锚定** | Gap起点 | 在源头明确边界和约束 | 1. 需求与约束并行定义<br>2. 结构化模板表达<br>3. 强制优先级拆分(P0/P1/P2) | 压缩LLM自由发挥空间，减少无效需求 | 中等 |
| **过程过滤** | Gap跨越后 | 立即净化和校验输出 | 1. 收敛与简化处理<br>2. 一致性自动校验<br>3. 生成偏离清单供人工确认 | 及时发现和修正偏差，防止噪声累积 | 中等 |
| **后置校验** | Gap终点 | 设置坚固的质量防火墙 | 1. 人工审核所有约束项<br>2. 基线校验对照清单<br>3. 强制单元测试覆盖 | 确保最终输出质量，阻止有问题的内容进入下一阶段 | 高 |
| **强制约束** | 全流程 | IDE层面的硬性规则控制 | 1. 禁止未授权文件创建<br>2. 严格任务清单执行<br>3. 禁止擅自变更范围 | 从工具层面限制LLM的行为边界 | 低 |

### 4.2 前置锚定（Anchor Upfront）

在Gap的起点就明确边界：

1. **需求与约束并行**：在生成PRD时，必须同时明确"要做什么"和"禁止做什么"（功能边界、技术限制、资源上限）。
2. **结构化表达**：使用（Who/Given/Then/Shall）等结构化模板编写需求，压缩LLM的自由发挥空间。
3. **强制拆分优先级**：明确P0（本周期的核心）、P1（后续迭代）、P2（远期）。仅对P0进行详细展开。

### 4.3 过程过滤（Filter in Process）

在跨越每个Gap后立即进行净化：

1. **收敛与简化**：生成SPEC后，立即要求LLM对其进行精简，砍非核心功能、合并重复交互、简化技术栈、精简系统结构。
2. **一致性校验**：使用LLM自动比对PRD与Spec、Spec与Tasklist，生成"偏离清单"，并引导人工逐一确认和修正。

### 4.4 后置校验（Verify at the End）

在Gap的终点设置坚固防火墙：

1. **人工审核**：所有约束项和最终任务清单必须经过人工最终审核。
2. **基线校验**：每个开发任务启动前，都必须对照P0需求清单和禁止约束清单进行确认。
3. **强制单元测试**：每个任务完成后，必须同步生成并通过单元测试，覆盖功能、边界和约束，否则不能继续。

### 4.5 强制约束（Enforce Constraints）

在IDE中配置硬性规则，引入人为干预：

- 禁止在未经用户允许的情况下创建程序文件。
- 严格执行任务清单，完成一项，验收一项，再推进下一项。
- 在任何阶段都遵循用户指令，不擅自变更需求、设计或范围。

## 5. 总结

用AI构建软件项目，你不再是追求代码编写速度，而是谁能更高效、高质量地治理LLM产生的噪声，谁能持续地、优雅地跨越四大鸿沟。

开发者需要转型为流程的监督者、规范的制定者和质量的守门人。产品、开发、测试角色越来越交叉，技能边界越来越模糊。

通过流程优化，提升SDD的信噪比，将LLM生成能力约束在期望的轨道上，这是使用AI进行开发的人都需要关注的，也是会长期从中受益的。

**Enjoy spec-coding！**

---

*（未完待续，后续我们会探索具体的SDD噪声/信噪比的评估和优化方案）*
